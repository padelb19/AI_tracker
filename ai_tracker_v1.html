<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI-tracker</title>
  <!-- Include Chart.js (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Global styles */
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: white;
    }

    /* Header */
    header {
      width: 100%;
      background-color: #f2f2f2;
      padding: 10px;
    }

    /* 3-column flex container for logo (left), title (center), optional right block */
    .header-top {
      display: flex;
      align-items: center;
    }
    .left-block, .center-block, .right-block {
      flex: 1;
      min-height: 50px;
    }
    .left-block {
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .right-block {
      /* empty placeholder if needed */
    }

    /* The logo */
    .logo {
      height: 80px;
      /* Adjust as needed */
    }

    /* The site title, centered in its column */
    .center-block {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    .center-block h1 {
      margin: 0;
      font-size: 1.8em;
    }

    /* Navigation bar below the top bar */
    nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 10px;
    }
    nav button {
      padding: 10px 20px;
      cursor: pointer;
      background-color: #fff;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    nav button:hover {
      background-color: #eee;
    }

    .page {
      display: none; /* all pages hidden by default; only the selected one is shown */
      padding: 20px;
    }
    .active {
      display: block; /* show the active page */
    }

    /* ACCUEIL PAGE */
    #accueil h2 {
      text-align: center;
      margin-top: 30px;
    }
    .explanation {
      max-width: 800px;
      margin: 30px auto;
      text-align: center;
      font-size: 1em;
      line-height: 1.4em;
    }
    .additional-figures {
      max-width: 1000px;
      margin: 40px auto;
    }
    .additional-figures h3 {
      text-align: center;
      margin-bottom: 20px;
    }
    .figures-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-bottom: 40px;
    }
    .key-figure-card {
      border: 1px solid #ccc;
      border-radius: 5px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      padding: 20px;
      width: 200px;
      text-align: center;
      background-color: #fff;
    }

    /* DASHBOARDS PAGE */
    #dashboards {
      margin: 0 auto;
      max-width: 1000px;
    }
    #dashboards h2 {
      margin-bottom: 10px;
      text-align: center;
    }
    .sub-nav {
      text-align: center;
      margin-bottom: 20px;
    }
    .sub-nav button {
      margin: 5px;
      background-color: #fff;
      border: 1px solid #ccc;
      cursor: pointer;
      border-radius: 4px;
    }
    .chart-section {
      margin-bottom: 40px;
    }
    .chart-controls {
      margin: 10px 0;
      text-align: center;
    }
    .chart-container {
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
    }

    /* Smaller pie chart container */
    #adoptersSection .chart-container {
      max-width: 400px;
    }

    /* PROJECTS PAGE */
    #projects h2 {
      text-align: center;
      margin-bottom: 40px;
    }
    #projects section {
      max-width: 800px;
      margin: 0 auto 30px auto;
    }
    #projects section h3 {
      border-bottom: 1px solid #ccc;
      padding-bottom: 5px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<header>
  <!-- 3-column layout: left (logo), center (title), right (empty) -->
  <div class="header-top">
    <div class="left-block">
      <img src="logo.png" alt="AI-tracker logo" class="logo" />
    </div>
    <div class="center-block">
      <h1>AI-tracker</h1>
    </div>
    <div class="right-block"></div>
  </div>

  <!-- Navigation bar below -->
  <nav>
    <button onclick="showPage('accueil')">Accueil</button>
    <button onclick="showPage('dashboards')">Dashboards</button>
    <button onclick="showPage('projects')">Projects</button>
  </nav>
</header>

<!-- ACCUEIL PAGE -->
<div id="accueil" class="page active">
  <h2>Welcome to the AI-tracker!</h2>
  <p style="text-align:center;">
    Here you can find insights into the evolution of AI adoption by French firms, based on their recruitment data.
  </p>
  
  <div class="explanation">
    This tracker is built using machine learning models on the JOCAS database, edited by the 
    French Ministry of Labor's DARES. By automatically detecting AI-related job offers, 
    the AI-tracker monitors the growing adoption of this technology within the French economy.
  </div>

  <!-- Additional Figures -->
  <div class="additional-figures">
    <!-- AI Figures -->
    <h3>Additional Key Figures - AI</h3>
    <div class="figures-row">
      <div class="key-figure-card">
        <h4>Firms Having Recruited for AI (Total)</h4>
        <p>8,500 (mock)</p>
      </div>
      <div class="key-figure-card">
        <h4>New Recruiters Last Quarter</h4>
        <p>400 (mock)</p>
        <p><small>+5% vs. previous quarter (mock)</small></p>
      </div>
      <div class="key-figure-card">
        <h4>Number of AI Offers (Total)</h4>
        <p>45,000 (mock)</p>
      </div>
      <div class="key-figure-card">
        <h4>AI Offers Last Quarter</h4>
        <p>6,000 (mock)</p>
        <p><small>+10% vs. previous quarter (mock)</small></p>
      </div>
    </div>

    <!-- Generative AI Figures -->
    <h3>Additional Key Figures - Generative AI</h3>
    <div class="figures-row">
      <div class="key-figure-card">
        <h4>Firms Having Recruited for Generative AI (Total)</h4>
        <p>2,000 (mock)</p>
      </div>
      <div class="key-figure-card">
        <h4>New Recruiters Last Quarter</h4>
        <p>150 (mock)</p>
        <p><small>+8% vs. previous quarter (mock)</small></p>
      </div>
      <div class="key-figure-card">
        <h4>Number of Generative AI Offers (Total)</h4>
        <p>20,000 (mock)</p>
      </div>
      <div class="key-figure-card">
        <h4>Generative AI Offers Last Quarter</h4>
        <p>2,000 (mock)</p>
        <p><small>+12% vs. previous quarter (mock)</small></p>
      </div>
    </div>
  </div>
</div>

<!-- DASHBOARDS PAGE -->
<div id="dashboards" class="page">
  <h2>Dashboards</h2>
  <div class="sub-nav">
    <button onclick="scrollToSection('totalOffersSection')">Total Offers</button>
    <button onclick="scrollToSection('sectorsSection')">Sectors</button>
    <button onclick="scrollToSection('locationSection')">Location</button>
    <button onclick="scrollToSection('adoptersSection')">Adopters</button>
  </div>

  <!-- 1. Evolution of total AI offers -->
  <div id="totalOffersSection" class="chart-section">
    <h3>Evolution of AI-Related Job Offers</h3>
    <div class="chart-controls">
      <!-- Toggle between total and share -->
      <button onclick="toggleTotalShare('offersChart')">Toggle Total / Share</button><br/><br/>
      <!-- Show/hide categories -->
      <label><input type="checkbox" checked onclick="toggleCategory('offersChart','cv')"> Computer Vision</label>
      <label><input type="checkbox" checked onclick="toggleCategory('offersChart','gen')"> IA Générative</label>
      <label><input type="checkbox" checked onclick="toggleCategory('offersChart','general')"> IA Générale</label>
    </div>
    <div class="chart-container">
      <canvas id="offersChart"></canvas>
    </div>
  </div>

  <!-- 2. Firms adopting AI by sector -->
  <div id="sectorsSection" class="chart-section">
    <h3>Firms Adopting AI by Sector</h3>
    <div class="chart-controls">
      <button onclick="toggleTotalShare('sectorsChart')">Toggle Total / Share</button><br/><br/>
      <label><input type="checkbox" checked onclick="toggleCategory('sectorsChart','industrie')"> Industrie</label>
      <label><input type="checkbox" checked onclick="toggleCategory('sectorsChart','service')"> Service</label>
    </div>
    <div class="chart-container">
      <canvas id="sectorsChart"></canvas>
    </div>
  </div>

  <!-- 3. Ranking of French Zones d’emploi -->
  <div id="locationSection" class="chart-section">
    <h3>Ranking of French Zones d’Emplois</h3>
    <div class="chart-controls">
      <button onclick="toggleTotalShare('zonesChart')">Toggle Total / Share</button>
    </div>
    <div class="chart-container">
      <canvas id="zonesChart"></canvas>
    </div>
  </div>

  <!-- 4. Ranking of sectors by share of AI offers -->
  <div class="chart-section">
    <h3>Ranking of Sectors by Share of AI Offers</h3>
    <div class="chart-container">
      <canvas id="sectorShareChart"></canvas>
    </div>
  </div>

  <!-- 5. Composition of AI adopters -->
  <div id="adoptersSection" class="chart-section">
    <h3>Composition of AI Adopters</h3>
    <div class="chart-container">
      <canvas id="adoptersChart"></canvas>
    </div>
  </div>
</div>

<!-- PROJECTS PAGE -->
<div id="projects" class="page">
  <h2>Projects</h2>
  <section class="authors">
    <h3>Authors</h3>
    <p>This AI-tracker is developed by three economists:</p>
    <ul>
      <li>Paul Delbouve</li>
      <li>Philippe Aghion</li>
      <li>Antonin Bergeaud</li>
    </ul>
  </section>
  <section class="papers">
    <h3>Academic Papers</h3>
    <p>
      Here you will find academic papers linked with this website and ongoing research projects related to AI adoption.
      <br /><br />
      <strong>Paper 1:</strong> <em>Title and Link (mock)</em><br />
      <strong>Paper 2:</strong> <em>Title and Link (mock)</em>
    </p>
  </section>
</div>

<script>
  /****************************************************
   * Page Navigation
   ****************************************************/
  function showPage(pageId) {
    const pages = document.querySelectorAll('.page');
    pages.forEach(page => page.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');
  }

  // Scroll within Dashboards
  function scrollToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (!section) return;
    showPage('dashboards');
    section.scrollIntoView({ behavior: 'smooth' });
  }

  /****************************************************
   * Mock Data
   ****************************************************/
  const months = ["Jan-19","Feb-19","Mar-19","Apr-19","May-19","Jun-19"];
  const totalDataCV      = [50, 60, 70, 40, 80, 90];
  const totalDataGen     = [30, 40, 50, 20, 10,  5];
  const totalDataGeneral = [20, 20, 30, 50, 20, 30];
  
  const shareDataCV      = [30, 25, 40, 35, 60, 50];
  const shareDataGen     = [50, 55, 40, 30, 20, 25];
  const shareDataGeneral = [20, 20, 20, 35, 20, 25];

  const timePeriods = ["2019","2020","2021","2022","2023"];
  const sectorDataIndustrie = [100, 120, 130, 150, 200];
  const sectorDataService   = [80,  100, 140, 190, 250];
  const sectorShareIndustrie = [10, 12, 15, 18, 20];
  const sectorShareService   = [8,  10, 14, 16, 18];

  const zones = ["Paris", "Lyon", "Marseille", "Toulouse", "Bordeaux"];
  const zonesTotal = [500, 300, 200, 150, 100];
  const zonesShare = [40, 25, 20, 15, 10];

  const sectorNames = ["Finance", "Manufacturing", "Retail", "Tech", "Healthcare"];
  const sectorShares = [25, 20, 15, 30, 10];

  const adopterLabels = ["PME", "ETI", "GE"];
  const adopterValues = [50, 30, 20];

  /****************************************************
   * Chart Variables
   ****************************************************/
  let offersChart, sectorsChart, zonesChart, sectorShareChart, adoptersChart;

  // Keep track of which mode is displayed: total or share
  let offersMode  = 'total';  // or 'share'
  let sectorsMode = 'total';  // or 'share'
  let zonesMode   = 'total';  // or 'share'

  /****************************************************
   * Chart Setup Functions
   ****************************************************/

  // 1) OFFERS CHART (stacked bar)
  function createOffersChart() {
    const ctx = document.getElementById("offersChart").getContext("2d");
    offersChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: months,
        datasets: [
          {
            label: 'Computer Vision',
            data: totalDataCV,
            backgroundColor: 'rgba(54, 162, 235, 0.7)',
            categoryKey: 'cv'
          },
          {
            label: 'IA Générative',
            data: totalDataGen,
            backgroundColor: 'rgba(255, 99, 132, 0.7)',
            categoryKey: 'gen'
          },
          {
            label: 'IA Générale',
            data: totalDataGeneral,
            backgroundColor: 'rgba(75, 192, 192, 0.7)',
            categoryKey: 'general'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          title: { display: false },
          tooltip: { mode: 'index', intersect: false }
        },
        scales: {
          x: { stacked: true },
          y: { stacked: true }
        }
      }
    });
  }

  // 2) SECTORS CHART
  function createSectorsChart() {
    const ctx = document.getElementById("sectorsChart").getContext("2d");
    sectorsChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: timePeriods,
        datasets: [
          {
            label: 'Industrie',
            data: sectorDataIndustrie,
            backgroundColor: 'rgba(153, 102, 255, 0.7)',
            categoryKey: 'industrie'
          },
          {
            label: 'Service',
            data: sectorDataService,
            backgroundColor: 'rgba(255, 205, 86, 0.7)',
            categoryKey: 'service'
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          x: { stacked: false },
          y: { stacked: false }
        }
      }
    });
  }

  // 3) ZONES CHART
  function createZonesChart() {
    const ctx = document.getElementById("zonesChart").getContext("2d");
    zonesChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: zones,
        datasets: [
          {
            label: 'AI Offers',
            data: zonesTotal,
            backgroundColor: 'rgba(255, 159, 64, 0.7)'
          }
        ]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        scales: {
          y: {
            title: {
              display: true,
              text: 'Total Offers'
            }
          },
          x: {}
        }
      }
    });
  }

  // 4) SECTOR SHARE CHART
  function createSectorShareChart() {
    const ctx = document.getElementById("sectorShareChart").getContext("2d");
    sectorShareChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: sectorNames,
        datasets: [
          {
            label: 'Share of AI Offers (%)',
            data: sectorShares,
            backgroundColor: 'rgba(255, 99, 132, 0.7)'
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            max: 100
          }
        }
      }
    });
  }

  // 5) ADOPTERS PIE CHART
  function createAdoptersChart() {
    const ctx = document.getElementById("adoptersChart").getContext("2d");
    adoptersChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: adopterLabels,
        datasets: [
          {
            label: 'Composition of AI Adopters',
            data: adopterValues,
            backgroundColor: [
              'rgba(54, 162, 235, 0.7)',
              'rgba(255, 206, 86, 0.7)',
              'rgba(75, 192, 192, 0.7)'
            ]
          }
        ]
      },
      options: {
        responsive: true
      }
    });
  }

  /****************************************************
   * Toggle Functions
   ****************************************************/

  // Toggle "Total" vs "Share" on a given chart
  function toggleTotalShare(chartName) {
    if (chartName === 'offersChart') {
      // Switch mode
      offersMode = (offersMode === 'total') ? 'share' : 'total';
      // Update dataset values
      if (offersMode === 'total') {
        offersChart.data.datasets[0].data = totalDataCV;
        offersChart.data.datasets[1].data = totalDataGen;
        offersChart.data.datasets[2].data = totalDataGeneral;
      } else {
        offersChart.data.datasets[0].data = shareDataCV;
        offersChart.data.datasets[1].data = shareDataGen;
        offersChart.data.datasets[2].data = shareDataGeneral;
      }
      offersChart.update();
    }
    else if (chartName === 'sectorsChart') {
      sectorsMode = (sectorsMode === 'total') ? 'share' : 'total';
      if (sectorsMode === 'total') {
        sectorsChart.data.datasets[0].data = sectorDataIndustrie;
        sectorsChart.data.datasets[1].data = sectorDataService;
      } else {
        sectorsChart.data.datasets[0].data = sectorShareIndustrie;
        sectorsChart.data.datasets[1].data = sectorShareService;
      }
      sectorsChart.update();
    }
    else if (chartName === 'zonesChart') {
      zonesMode = (zonesMode === 'total') ? 'share' : 'total';
      if (zonesMode === 'total') {
        zonesChart.data.datasets[0].data = zonesTotal;
        zonesChart.options.scales.y.title.text = 'Total Offers';
      } else {
        zonesChart.data.datasets[0].data = zonesShare;
        zonesChart.options.scales.y.title.text = 'Share (%)';
      }
      zonesChart.update();
    }
  }

  // Toggle the visibility of a specific category (dataset) in offersChart or sectorsChart
  function toggleCategory(chartName, categoryKey) {
    let chart;
    if (chartName === 'offersChart') {
      chart = offersChart;
    } else if (chartName === 'sectorsChart') {
      chart = sectorsChart;
    }
    if (!chart) return;

    // Find the dataset whose custom "categoryKey" matches
    const ds = chart.data.datasets.find(ds => ds.categoryKey === categoryKey);
    if (!ds) return;

    // Toggle hidden property
    ds.hidden = !ds.hidden;
    chart.update();
  }

  /****************************************************
   * Initialize Charts on Page Load
   ****************************************************/
  window.onload = function() {
    createOffersChart();
    createSectorsChart();
    createZonesChart();
    createSectorShareChart();
    createAdoptersChart();
  };
</script>
</body>
</html>
